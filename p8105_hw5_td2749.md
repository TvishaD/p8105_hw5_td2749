p8105_hw5_td2749
================
Tvisha R. Devavarapu
2022-11-03

``` r
library(tidyverse)
library(plotly)

knitr::opts_chunk$set(
  fig.width = 10,
  fig.asp = .6,
  out.width = "90%"
)
```

# Problem 2

``` r
homicide_data = 
  read_csv("./data/homicide-data.csv") %>%
  janitor::clean_names() %>% 
    unite(city_state, c(city, state), sep = ",", remove = FALSE) %>% 
    group_by(city_state, disposition) %>% 
      summarize(cases = n()) %>%
      pivot_wider(names_from = disposition, values_from = cases) %>% 
      janitor::clean_names() %>% 
      replace(is.na(.), 0) %>% 
      mutate(total_cases = closed_by_arrest + closed_without_arrest + open_no_arrest) %>% 
      mutate(unsolved_cases = closed_without_arrest + open_no_arrest) %>% 
      select(city_state, unsolved_cases, total_cases)
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## `summarise()` has grouped output by 'city_state'. You can override using the `.groups` argument.

``` r
head(homicide_data)
```

    ## # A tibble: 6 × 3
    ## # Groups:   city_state [6]
    ##   city_state     unsolved_cases total_cases
    ##   <chr>                   <int>       <int>
    ## 1 Albuquerque,NM            146         378
    ## 2 Atlanta,GA                373         973
    ## 3 Baltimore,MD             1825        2827
    ## 4 Baton Rouge,LA            196         424
    ## 5 Birmingham,AL             347         800
    ## 6 Boston,MA                 310         614

**Raw Data Description**: The raw data consists of 51 rows of
observations and 3 columns of variables. Each row identifies a distinct
homicide victim’s information. The variables are city_state,
unsolved_cases, total_cases. From these pieces of information, we get a
picture of each victim’s personal details, date of the homicide,
location, and the disposition of the case. There are some missing values
(NA) in the latitude and longitude columns. Most columns contain
character values. Several cells in the `race`, `age`, and `sex` columns
contain ‘Unknown’, reflecting the missing information regarding the
specific individuals. There are some cities (Boston, Los Angeles,
Louisville, Oakland, and Pittsburgh) where there are no cases labelled
as “closed without arrest”.

``` r
balt_x = homicide_data %>% filter(city_state == "Baltimore,MD") %>% pull(unsolved_cases)
balt_n = homicide_data %>% filter(city_state == "Baltimore,MD") %>% pull(total_cases)

baltimore_proptest = 
  prop.test(balt_x, balt_n) %>% 
  broom::tidy()

# balt_unsolved_prop
baltimore_proptest %>% pull(estimate)
```

    ##         p 
    ## 0.6455607

``` r
# balt_lower_bound
baltimore_proptest %>% pull(conf.low)
```

    ## [1] 0.6275625

``` r
# balt_upper_bound
baltimore_proptest %>% pull(conf.high)
```

    ## [1] 0.6631599

``` r
homicide_prop_results =
  homicide_data %>% 
    mutate(purrr::map2_df(.x = unsolved_cases, .y = total_cases, ~broom::tidy(prop.test(x = .x, n = .y)))) %>% 
    select(city_state, unsolved_cases, total_cases, estimate, conf.low, conf.high) %>% 
    rename(unsolved_prop = estimate)
```

    ## Warning in prop.test(x = .x, n = .y): Chi-squared approximation may be incorrect
